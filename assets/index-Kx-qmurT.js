(function(){const g=document.createElement("link").relList;if(g&&g.supports&&g.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))y(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const f of a.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&y(f)}).observe(document,{childList:!0,subtree:!0});function l(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function y(s){if(s.ep)return;s.ep=!0;const a=l(s);fetch(s.href,a)}})();document.addEventListener("DOMContentLoaded",()=>{console.log("DOM fully loaded and parsed");const m=document.getElementById("arrow"),g=document.getElementById("distanceText");m?console.log("Arrow model found in DOM"):console.error("Arrow model not found in DOM");const l={latitude:51.935918,longitude:7.650877};"geolocation"in navigator?(console.log("Geolocation is supported"),navigator.geolocation.watchPosition(e=>{const{latitude:n,longitude:t}=e.coords;console.log(`User position updated: lat=${n}, lon=${t}`),y(n,t),s(n,t),P(n,t)},e=>console.error("Geolocation error:",e),{enableHighAccuracy:!0,maximumAge:0,timeout:5e3})):console.error("Geolocation not supported by this browser.");function y(e,n){const t=b(e,n,l.latitude,l.longitude);console.log(`Calculated bearing: ${t} degrees`),m.setAttribute("rotation",`0 ${t} 0`)}function s(e,n){console.log(`Updating arrow position for user: lat=${e}, lon=${n}`);const t=a(e,n,l.latitude,l.longitude),o=f(e,n,t,2);m.setAttribute("gps-entity-place",`latitude: ${o.latitude}; longitude: ${o.longitude};`)}function a(e,n,t,c){const o=r=>r*Math.PI/180,d=o(c-n),u=Math.sin(d)*Math.cos(o(t)),i=Math.cos(o(e))*Math.sin(o(t))-Math.sin(o(e))*Math.cos(o(t))*Math.cos(d);return Math.atan2(u,i)}function f(e,n,t,c){const o=p=>p*Math.PI/180,d=p=>p*180/Math.PI,i=o(e),h=o(n),r=Math.asin(Math.sin(i)*Math.cos(c/6371e3)+Math.cos(i)*Math.sin(c/6371e3)*Math.cos(t)),M=h+Math.atan2(Math.sin(t)*Math.sin(c/6371e3)*Math.cos(i),Math.cos(c/6371e3)-Math.sin(i)*Math.sin(r));return{latitude:d(r),longitude:d(M)}}function P(e,n){const t=w(e,n,l.latitude,l.longitude);g.setAttribute("text","value",`${Math.round(t)} m`)}function b(e,n,t,c){const o=M=>M*Math.PI/180,d=M=>M*180/Math.PI,u=o(c-n),i=Math.sin(u)*Math.cos(o(t)),h=Math.cos(o(e))*Math.sin(o(t))-Math.sin(o(e))*Math.cos(o(t))*Math.cos(u);let r=d(Math.atan2(i,h));return r=(r+360)%360,console.log(`Bearing calculation result: ${r}`),r}function w(e,n,t,c){const o=p=>p*Math.PI/180,u=o(t-e),i=o(c-n),h=Math.sin(u/2)*Math.sin(u/2)+Math.cos(o(e))*Math.cos(o(t))*Math.sin(i/2)*Math.sin(i/2);return 6371*(2*Math.atan2(Math.sqrt(h),Math.sqrt(1-h)))*1e3}});
