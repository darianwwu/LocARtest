(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const r of i.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&s(r)}).observe(document,{childList:!0,subtree:!0});function e(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(n){if(n.ep)return;n.ep=!0;const i=e(n);fetch(n.href,i)}})();const J=navigator.userAgent.match(/iPhone|iPad|iPod/i);function H(_){const t=this;this.object=_,this.object.rotation.reorder("YXZ"),this.enabled=!0,this.deviceOrientation=null,this.screenOrientation=0,this.alphaOffset=0,this.initialOffset=null;const e=function({alpha:r,beta:h,gamma:o,webkitCompassHeading:a}){if(J){const c=360-a;t.alphaOffset=THREE.MathUtils.degToRad(c-r),t.deviceOrientation={alpha:r,beta:h,gamma:o,webkitCompassHeading:a}}else r<0&&(r+=360),t.deviceOrientation={alpha:r,beta:h,gamma:o};window.dispatchEvent(new CustomEvent("camera-rotation-change",{detail:{cameraRotation:_.rotation}}))},s=function(){t.screenOrientation=window.orientation||0},n=(function(){window.addEventListener("orientationchange",s,!1),J?window.addEventListener("deviceorientation",e,!1):window.addEventListener("deviceorientationabsolute",e,!1)}).bind(this),i=function(){const r=new THREE.Vector3(0,0,1),h=new THREE.Euler,o=new THREE.Quaternion,a=new THREE.Quaternion(-Math.sqrt(.5),0,0,Math.sqrt(.5));return function(c,l,d,u,y){h.set(d,l,-u,"YXZ"),c.setFromEuler(h),c.multiply(a),c.multiply(o.setFromAxisAngle(r,-y))}}();this.connect=function(){s(),window.DeviceOrientationEvent!==void 0&&typeof window.DeviceOrientationEvent.requestPermission=="function"?window.DeviceOrientationEvent.requestPermission().then(function(r){r=="granted"&&n()}).catch(function(r){console.error("THREE.AbsoluteDeviceOrientationControls: Unable to use DeviceOrientation API:",r)}):n(),t.enabled=!0},this.disconnect=function(){J?(window.removeEventListener("orientationchange",s,!1),window.removeEventListener("deviceorientation",e,!1)):(window.removeEventListener("orientationchange",s,!1),window.removeEventListener("deviceorientationabsolute",e,!1)),t.enabled=!1,t.initialOffset=!1,t.deviceOrientation=null},this.update=function({theta:r=0}={theta:0}){if(t.enabled===!1)return;const h=t.deviceOrientation;if(h){const o=h.alpha?THREE.MathUtils.degToRad(h.alpha):0,a=h.beta?THREE.MathUtils.degToRad(h.beta):0,c=h.gamma?THREE.MathUtils.degToRad(h.gamma):0,l=t.screenOrientation?THREE.MathUtils.degToRad(t.screenOrientation):0;if(J){const d=new THREE.Quaternion;i(d,o,a,c,l);const u=new THREE.Euler().setFromQuaternion(d,"YXZ");console.log(u.x,u.y,u.z),u.y=THREE.MathUtils.degToRad(360-h.webkitCompassHeading),d.setFromEuler(u),t.object.quaternion.copy(d)}else i(t.object.quaternion,o+r,a,c,l)}},this.updateAlphaOffset=function(){t.initialOffset=!1},this.dispose=function(){t.disconnect()},this.getAlpha=function(){const{deviceOrientation:r}=t;return r&&r.alpha?THREE.MathUtils.degToRad(r.alpha)+t.alphaOffset:0},this.getBeta=function(){const{deviceOrientation:r}=t;return r&&r.beta?THREE.MathUtils.degToRad(r.beta):0},this.getGamma=function(){const{deviceOrientation:r}=t;return r&&r.gamma?THREE.MathUtils.degToRad(r.gamma):0},this.connect()}H.prototype=Object.assign(Object.create(THREE.EventDispatcher.prototype),{constructor:H});/**
 * @license
 * Copyright 2010-2024 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const xt="169",tt=2e3,lt=2001,g=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let ut=1234567;const Mt=Math.PI/180,zt=180/Math.PI;function wt(){const _=Math.random()*4294967295|0,t=Math.random()*4294967295|0,e=Math.random()*4294967295|0,s=Math.random()*4294967295|0;return(g[_&255]+g[_>>8&255]+g[_>>16&255]+g[_>>24&255]+"-"+g[t&255]+g[t>>8&255]+"-"+g[t>>16&15|64]+g[t>>24&255]+"-"+g[e&63|128]+g[e>>8&255]+"-"+g[e>>16&255]+g[e>>24&255]+g[s&255]+g[s>>8&255]+g[s>>16&255]+g[s>>24&255]).toLowerCase()}function A(_,t,e){return Math.max(t,Math.min(e,_))}function ft(_,t){return(_%t+t)%t}function bt(_,t,e,s,n){return s+(_-t)*(n-s)/(e-t)}function Et(_,t,e){return _!==t?(e-_)/(t-_):0}function pt(_,t,e){return(1-e)*_+e*t}function Ct(_,t,e,s){return pt(_,t,1-Math.exp(-e*s))}function kt(_,t=1){return t-Math.abs(ft(_,t*2)-t)}function Tt(_,t,e){return _<=t?0:_>=e?1:(_=(_-t)/(e-t),_*_*(3-2*_))}function Rt(_,t,e){return _<=t?0:_>=e?1:(_=(_-t)/(e-t),_*_*_*(_*(_*6-15)+10))}function At(_,t){return _+Math.floor(Math.random()*(t-_+1))}function St(_,t){return _+Math.random()*(t-_)}function It(_){return _*(.5-Math.random())}function Ft(_){_!==void 0&&(ut=_);let t=ut+=1831565813;return t=Math.imul(t^t>>>15,t|1),t^=t+Math.imul(t^t>>>7,t|61),((t^t>>>14)>>>0)/4294967296}function Pt(_){return _*Mt}function Ot(_){return _*zt}function Dt(_){return(_&_-1)===0&&_!==0}function Ht(_){return Math.pow(2,Math.ceil(Math.log(_)/Math.LN2))}function Zt(_){return Math.pow(2,Math.floor(Math.log(_)/Math.LN2))}function Lt(_,t,e,s,n){const i=Math.cos,r=Math.sin,h=i(e/2),o=r(e/2),a=i((t+s)/2),c=r((t+s)/2),l=i((t-s)/2),d=r((t-s)/2),u=i((s-t)/2),y=r((s-t)/2);switch(n){case"XYX":_.set(h*c,o*l,o*d,h*a);break;case"YZY":_.set(o*d,h*c,o*l,h*a);break;case"ZXZ":_.set(o*l,o*d,h*c,h*a);break;case"XZX":_.set(h*c,o*y,o*u,h*a);break;case"YXY":_.set(o*u,h*c,o*y,h*a);break;case"ZYZ":_.set(o*y,o*u,h*c,h*a);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+n)}}function Yt(_,t){switch(t.constructor){case Float32Array:return _;case Uint32Array:return _/4294967295;case Uint16Array:return _/65535;case Uint8Array:return _/255;case Int32Array:return Math.max(_/2147483647,-1);case Int16Array:return Math.max(_/32767,-1);case Int8Array:return Math.max(_/127,-1);default:throw new Error("Invalid component type.")}}function Xt(_,t){switch(t.constructor){case Float32Array:return _;case Uint32Array:return Math.round(_*4294967295);case Uint16Array:return Math.round(_*65535);case Uint8Array:return Math.round(_*255);case Int32Array:return Math.round(_*2147483647);case Int16Array:return Math.round(_*32767);case Int8Array:return Math.round(_*127);default:throw new Error("Invalid component type.")}}const qt={DEG2RAD:Mt,RAD2DEG:zt,generateUUID:wt,clamp:A,euclideanModulo:ft,mapLinear:bt,inverseLerp:Et,lerp:pt,damp:Ct,pingpong:kt,smoothstep:Tt,smootherstep:Rt,randInt:At,randFloat:St,randFloatSpread:It,seededRandom:Ft,degToRad:Pt,radToDeg:Ot,isPowerOfTwo:Dt,ceilPowerOfTwo:Ht,floorPowerOfTwo:Zt,setQuaternionFromProperEuler:Lt,normalize:Xt,denormalize:Yt};class gt{constructor(t=0,e=0,s=0,n=1){this.isQuaternion=!0,this._x=t,this._y=e,this._z=s,this._w=n}static slerpFlat(t,e,s,n,i,r,h){let o=s[n+0],a=s[n+1],c=s[n+2],l=s[n+3];const d=i[r+0],u=i[r+1],y=i[r+2],m=i[r+3];if(h===0){t[e+0]=o,t[e+1]=a,t[e+2]=c,t[e+3]=l;return}if(h===1){t[e+0]=d,t[e+1]=u,t[e+2]=y,t[e+3]=m;return}if(l!==m||o!==d||a!==u||c!==y){let M=1-h;const x=o*d+a*u+c*y+l*m,E=x>=0?1:-1,C=1-x*x;if(C>Number.EPSILON){const f=Math.sqrt(C),b=Math.atan2(f,x*E);M=Math.sin(M*b)/f,h=Math.sin(h*b)/f}const w=h*E;if(o=o*M+d*w,a=a*M+u*w,c=c*M+y*w,l=l*M+m*w,M===1-h){const f=1/Math.sqrt(o*o+a*a+c*c+l*l);o*=f,a*=f,c*=f,l*=f}}t[e]=o,t[e+1]=a,t[e+2]=c,t[e+3]=l}static multiplyQuaternionsFlat(t,e,s,n,i,r){const h=s[n],o=s[n+1],a=s[n+2],c=s[n+3],l=i[r],d=i[r+1],u=i[r+2],y=i[r+3];return t[e]=h*y+c*l+o*u-a*d,t[e+1]=o*y+c*d+a*l-h*u,t[e+2]=a*y+c*u+h*d-o*l,t[e+3]=c*y-h*l-o*d-a*u,t}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get w(){return this._w}set w(t){this._w=t,this._onChangeCallback()}set(t,e,s,n){return this._x=t,this._y=e,this._z=s,this._w=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this}setFromEuler(t,e=!0){const s=t._x,n=t._y,i=t._z,r=t._order,h=Math.cos,o=Math.sin,a=h(s/2),c=h(n/2),l=h(i/2),d=o(s/2),u=o(n/2),y=o(i/2);switch(r){case"XYZ":this._x=d*c*l+a*u*y,this._y=a*u*l-d*c*y,this._z=a*c*y+d*u*l,this._w=a*c*l-d*u*y;break;case"YXZ":this._x=d*c*l+a*u*y,this._y=a*u*l-d*c*y,this._z=a*c*y-d*u*l,this._w=a*c*l+d*u*y;break;case"ZXY":this._x=d*c*l-a*u*y,this._y=a*u*l+d*c*y,this._z=a*c*y+d*u*l,this._w=a*c*l-d*u*y;break;case"ZYX":this._x=d*c*l-a*u*y,this._y=a*u*l+d*c*y,this._z=a*c*y-d*u*l,this._w=a*c*l+d*u*y;break;case"YZX":this._x=d*c*l+a*u*y,this._y=a*u*l+d*c*y,this._z=a*c*y-d*u*l,this._w=a*c*l-d*u*y;break;case"XZY":this._x=d*c*l-a*u*y,this._y=a*u*l-d*c*y,this._z=a*c*y+d*u*l,this._w=a*c*l+d*u*y;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+r)}return e===!0&&this._onChangeCallback(),this}setFromAxisAngle(t,e){const s=e/2,n=Math.sin(s);return this._x=t.x*n,this._y=t.y*n,this._z=t.z*n,this._w=Math.cos(s),this._onChangeCallback(),this}setFromRotationMatrix(t){const e=t.elements,s=e[0],n=e[4],i=e[8],r=e[1],h=e[5],o=e[9],a=e[2],c=e[6],l=e[10],d=s+h+l;if(d>0){const u=.5/Math.sqrt(d+1);this._w=.25/u,this._x=(c-o)*u,this._y=(i-a)*u,this._z=(r-n)*u}else if(s>h&&s>l){const u=2*Math.sqrt(1+s-h-l);this._w=(c-o)/u,this._x=.25*u,this._y=(n+r)/u,this._z=(i+a)/u}else if(h>l){const u=2*Math.sqrt(1+h-s-l);this._w=(i-a)/u,this._x=(n+r)/u,this._y=.25*u,this._z=(o+c)/u}else{const u=2*Math.sqrt(1+l-s-h);this._w=(r-n)/u,this._x=(i+a)/u,this._y=(o+c)/u,this._z=.25*u}return this._onChangeCallback(),this}setFromUnitVectors(t,e){let s=t.dot(e)+1;return s<Number.EPSILON?(s=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=s):(this._x=0,this._y=-t.z,this._z=t.y,this._w=s)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=s),this.normalize()}angleTo(t){return 2*Math.acos(Math.abs(A(this.dot(t),-1,1)))}rotateTowards(t,e){const s=this.angleTo(t);if(s===0)return this;const n=Math.min(1,e/s);return this.slerp(t,n),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let t=this.length();return t===0?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this}multiply(t){return this.multiplyQuaternions(this,t)}premultiply(t){return this.multiplyQuaternions(t,this)}multiplyQuaternions(t,e){const s=t._x,n=t._y,i=t._z,r=t._w,h=e._x,o=e._y,a=e._z,c=e._w;return this._x=s*c+r*h+n*a-i*o,this._y=n*c+r*o+i*h-s*a,this._z=i*c+r*a+s*o-n*h,this._w=r*c-s*h-n*o-i*a,this._onChangeCallback(),this}slerp(t,e){if(e===0)return this;if(e===1)return this.copy(t);const s=this._x,n=this._y,i=this._z,r=this._w;let h=r*t._w+s*t._x+n*t._y+i*t._z;if(h<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,h=-h):this.copy(t),h>=1)return this._w=r,this._x=s,this._y=n,this._z=i,this;const o=1-h*h;if(o<=Number.EPSILON){const u=1-e;return this._w=u*r+e*this._w,this._x=u*s+e*this._x,this._y=u*n+e*this._y,this._z=u*i+e*this._z,this.normalize(),this}const a=Math.sqrt(o),c=Math.atan2(a,h),l=Math.sin((1-e)*c)/a,d=Math.sin(e*c)/a;return this._w=r*l+this._w*d,this._x=s*l+this._x*d,this._y=n*l+this._y*d,this._z=i*l+this._z*d,this._onChangeCallback(),this}slerpQuaternions(t,e,s){return this.copy(t).slerp(e,s)}random(){const t=2*Math.PI*Math.random(),e=2*Math.PI*Math.random(),s=Math.random(),n=Math.sqrt(1-s),i=Math.sqrt(s);return this.set(n*Math.sin(t),n*Math.cos(t),i*Math.sin(e),i*Math.cos(e))}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w}fromArray(t,e=0){return this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t}fromBufferAttribute(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class I{constructor(t=0,e=0,s=0){I.prototype.isVector3=!0,this.x=t,this.y=e,this.z=s}set(t,e,s){return s===void 0&&(s=this.z),this.x=t,this.y=e,this.z=s,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}multiplyVectors(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this}applyEuler(t){return this.applyQuaternion(dt.setFromEuler(t))}applyAxisAngle(t,e){return this.applyQuaternion(dt.setFromAxisAngle(t,e))}applyMatrix3(t){const e=this.x,s=this.y,n=this.z,i=t.elements;return this.x=i[0]*e+i[3]*s+i[6]*n,this.y=i[1]*e+i[4]*s+i[7]*n,this.z=i[2]*e+i[5]*s+i[8]*n,this}applyNormalMatrix(t){return this.applyMatrix3(t).normalize()}applyMatrix4(t){const e=this.x,s=this.y,n=this.z,i=t.elements,r=1/(i[3]*e+i[7]*s+i[11]*n+i[15]);return this.x=(i[0]*e+i[4]*s+i[8]*n+i[12])*r,this.y=(i[1]*e+i[5]*s+i[9]*n+i[13])*r,this.z=(i[2]*e+i[6]*s+i[10]*n+i[14])*r,this}applyQuaternion(t){const e=this.x,s=this.y,n=this.z,i=t.x,r=t.y,h=t.z,o=t.w,a=2*(r*n-h*s),c=2*(h*e-i*n),l=2*(i*s-r*e);return this.x=e+o*a+r*l-h*c,this.y=s+o*c+h*a-i*l,this.z=n+o*l+i*c-r*a,this}project(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}unproject(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}transformDirection(t){const e=this.x,s=this.y,n=this.z,i=t.elements;return this.x=i[0]*e+i[4]*s+i[8]*n,this.y=i[1]*e+i[5]*s+i[9]*n,this.z=i[2]*e+i[6]*s+i[10]*n,this.normalize()}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}divideScalar(t){return this.multiplyScalar(1/t)}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this}clampLength(t,e){const s=this.length();return this.divideScalar(s||1).multiplyScalar(Math.max(t,Math.min(e,s)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this}lerpVectors(t,e,s){return this.x=t.x+(e.x-t.x)*s,this.y=t.y+(e.y-t.y)*s,this.z=t.z+(e.z-t.z)*s,this}cross(t){return this.crossVectors(this,t)}crossVectors(t,e){const s=t.x,n=t.y,i=t.z,r=e.x,h=e.y,o=e.z;return this.x=n*o-i*h,this.y=i*r-s*o,this.z=s*h-n*r,this}projectOnVector(t){const e=t.lengthSq();if(e===0)return this.set(0,0,0);const s=t.dot(this)/e;return this.copy(t).multiplyScalar(s)}projectOnPlane(t){return ot.copy(this).projectOnVector(t),this.sub(ot)}reflect(t){return this.sub(ot.copy(t).multiplyScalar(2*this.dot(t)))}angleTo(t){const e=Math.sqrt(this.lengthSq()*t.lengthSq());if(e===0)return Math.PI/2;const s=this.dot(t)/e;return Math.acos(A(s,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,s=this.y-t.y,n=this.z-t.z;return e*e+s*s+n*n}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}setFromSpherical(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}setFromSphericalCoords(t,e,s){const n=Math.sin(e)*t;return this.x=n*Math.sin(s),this.y=Math.cos(e)*t,this.z=n*Math.cos(s),this}setFromCylindrical(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}setFromCylindricalCoords(t,e,s){return this.x=t*Math.sin(e),this.y=s,this.z=t*Math.cos(e),this}setFromMatrixPosition(t){const e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this}setFromMatrixScale(t){const e=this.setFromMatrixColumn(t,0).length(),s=this.setFromMatrixColumn(t,1).length(),n=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=s,this.z=n,this}setFromMatrixColumn(t,e){return this.fromArray(t.elements,e*4)}setFromMatrix3Column(t,e){return this.fromArray(t.elements,e*3)}setFromEuler(t){return this.x=t._x,this.y=t._y,this.z=t._z,this}setFromColor(t){return this.x=t.r,this.y=t.g,this.z=t.b,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const t=Math.random()*Math.PI*2,e=Math.random()*2-1,s=Math.sqrt(1-e*e);return this.x=s*Math.cos(t),this.y=e,this.z=s*Math.sin(t),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const ot=new I,dt=new gt;class L{constructor(t,e,s,n,i,r,h,o,a,c,l,d,u,y,m,M){L.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],t!==void 0&&this.set(t,e,s,n,i,r,h,o,a,c,l,d,u,y,m,M)}set(t,e,s,n,i,r,h,o,a,c,l,d,u,y,m,M){const x=this.elements;return x[0]=t,x[4]=e,x[8]=s,x[12]=n,x[1]=i,x[5]=r,x[9]=h,x[13]=o,x[2]=a,x[6]=c,x[10]=l,x[14]=d,x[3]=u,x[7]=y,x[11]=m,x[15]=M,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new L().fromArray(this.elements)}copy(t){const e=this.elements,s=t.elements;return e[0]=s[0],e[1]=s[1],e[2]=s[2],e[3]=s[3],e[4]=s[4],e[5]=s[5],e[6]=s[6],e[7]=s[7],e[8]=s[8],e[9]=s[9],e[10]=s[10],e[11]=s[11],e[12]=s[12],e[13]=s[13],e[14]=s[14],e[15]=s[15],this}copyPosition(t){const e=this.elements,s=t.elements;return e[12]=s[12],e[13]=s[13],e[14]=s[14],this}setFromMatrix3(t){const e=t.elements;return this.set(e[0],e[3],e[6],0,e[1],e[4],e[7],0,e[2],e[5],e[8],0,0,0,0,1),this}extractBasis(t,e,s){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),s.setFromMatrixColumn(this,2),this}makeBasis(t,e,s){return this.set(t.x,e.x,s.x,0,t.y,e.y,s.y,0,t.z,e.z,s.z,0,0,0,0,1),this}extractRotation(t){const e=this.elements,s=t.elements,n=1/O.setFromMatrixColumn(t,0).length(),i=1/O.setFromMatrixColumn(t,1).length(),r=1/O.setFromMatrixColumn(t,2).length();return e[0]=s[0]*n,e[1]=s[1]*n,e[2]=s[2]*n,e[3]=0,e[4]=s[4]*i,e[5]=s[5]*i,e[6]=s[6]*i,e[7]=0,e[8]=s[8]*r,e[9]=s[9]*r,e[10]=s[10]*r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromEuler(t){const e=this.elements,s=t.x,n=t.y,i=t.z,r=Math.cos(s),h=Math.sin(s),o=Math.cos(n),a=Math.sin(n),c=Math.cos(i),l=Math.sin(i);if(t.order==="XYZ"){const d=r*c,u=r*l,y=h*c,m=h*l;e[0]=o*c,e[4]=-o*l,e[8]=a,e[1]=u+y*a,e[5]=d-m*a,e[9]=-h*o,e[2]=m-d*a,e[6]=y+u*a,e[10]=r*o}else if(t.order==="YXZ"){const d=o*c,u=o*l,y=a*c,m=a*l;e[0]=d+m*h,e[4]=y*h-u,e[8]=r*a,e[1]=r*l,e[5]=r*c,e[9]=-h,e[2]=u*h-y,e[6]=m+d*h,e[10]=r*o}else if(t.order==="ZXY"){const d=o*c,u=o*l,y=a*c,m=a*l;e[0]=d-m*h,e[4]=-r*l,e[8]=y+u*h,e[1]=u+y*h,e[5]=r*c,e[9]=m-d*h,e[2]=-r*a,e[6]=h,e[10]=r*o}else if(t.order==="ZYX"){const d=r*c,u=r*l,y=h*c,m=h*l;e[0]=o*c,e[4]=y*a-u,e[8]=d*a+m,e[1]=o*l,e[5]=m*a+d,e[9]=u*a-y,e[2]=-a,e[6]=h*o,e[10]=r*o}else if(t.order==="YZX"){const d=r*o,u=r*a,y=h*o,m=h*a;e[0]=o*c,e[4]=m-d*l,e[8]=y*l+u,e[1]=l,e[5]=r*c,e[9]=-h*c,e[2]=-a*c,e[6]=u*l+y,e[10]=d-m*l}else if(t.order==="XZY"){const d=r*o,u=r*a,y=h*o,m=h*a;e[0]=o*c,e[4]=-l,e[8]=a*c,e[1]=d*l+m,e[5]=r*c,e[9]=u*l-y,e[2]=y*l-u,e[6]=h*c,e[10]=m*l+d}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromQuaternion(t){return this.compose(vt,t,Ut)}lookAt(t,e,s){const n=this.elements;return k.subVectors(t,e),k.lengthSq()===0&&(k.z=1),k.normalize(),F.crossVectors(s,k),F.lengthSq()===0&&(Math.abs(s.z)===1?k.x+=1e-4:k.z+=1e-4,k.normalize(),F.crossVectors(s,k)),F.normalize(),et.crossVectors(k,F),n[0]=F.x,n[4]=et.x,n[8]=k.x,n[1]=F.y,n[5]=et.y,n[9]=k.y,n[2]=F.z,n[6]=et.z,n[10]=k.z,this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const s=t.elements,n=e.elements,i=this.elements,r=s[0],h=s[4],o=s[8],a=s[12],c=s[1],l=s[5],d=s[9],u=s[13],y=s[2],m=s[6],M=s[10],x=s[14],E=s[3],C=s[7],w=s[11],f=s[15],b=n[0],z=n[4],Y=n[8],X=n[12],q=n[1],v=n[5],U=n[9],Q=n[13],j=n[2],B=n[6],V=n[10],N=n[14],G=n[3],$=n[7],K=n[11],W=n[15];return i[0]=r*b+h*q+o*j+a*G,i[4]=r*z+h*v+o*B+a*$,i[8]=r*Y+h*U+o*V+a*K,i[12]=r*X+h*Q+o*N+a*W,i[1]=c*b+l*q+d*j+u*G,i[5]=c*z+l*v+d*B+u*$,i[9]=c*Y+l*U+d*V+u*K,i[13]=c*X+l*Q+d*N+u*W,i[2]=y*b+m*q+M*j+x*G,i[6]=y*z+m*v+M*B+x*$,i[10]=y*Y+m*U+M*V+x*K,i[14]=y*X+m*Q+M*N+x*W,i[3]=E*b+C*q+w*j+f*G,i[7]=E*z+C*v+w*B+f*$,i[11]=E*Y+C*U+w*V+f*K,i[15]=E*X+C*Q+w*N+f*W,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this}determinant(){const t=this.elements,e=t[0],s=t[4],n=t[8],i=t[12],r=t[1],h=t[5],o=t[9],a=t[13],c=t[2],l=t[6],d=t[10],u=t[14],y=t[3],m=t[7],M=t[11],x=t[15];return y*(+i*o*l-n*a*l-i*h*d+s*a*d+n*h*u-s*o*u)+m*(+e*o*u-e*a*d+i*r*d-n*r*u+n*a*c-i*o*c)+M*(+e*a*l-e*h*u-i*r*l+s*r*u+i*h*c-s*a*c)+x*(-n*h*c-e*o*l+e*h*d+n*r*l-s*r*d+s*o*c)}transpose(){const t=this.elements;let e;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}setPosition(t,e,s){const n=this.elements;return t.isVector3?(n[12]=t.x,n[13]=t.y,n[14]=t.z):(n[12]=t,n[13]=e,n[14]=s),this}invert(){const t=this.elements,e=t[0],s=t[1],n=t[2],i=t[3],r=t[4],h=t[5],o=t[6],a=t[7],c=t[8],l=t[9],d=t[10],u=t[11],y=t[12],m=t[13],M=t[14],x=t[15],E=l*M*a-m*d*a+m*o*u-h*M*u-l*o*x+h*d*x,C=y*d*a-c*M*a-y*o*u+r*M*u+c*o*x-r*d*x,w=c*m*a-y*l*a+y*h*u-r*m*u-c*h*x+r*l*x,f=y*l*o-c*m*o-y*h*d+r*m*d+c*h*M-r*l*M,b=e*E+s*C+n*w+i*f;if(b===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const z=1/b;return t[0]=E*z,t[1]=(m*d*i-l*M*i-m*n*u+s*M*u+l*n*x-s*d*x)*z,t[2]=(h*M*i-m*o*i+m*n*a-s*M*a-h*n*x+s*o*x)*z,t[3]=(l*o*i-h*d*i-l*n*a+s*d*a+h*n*u-s*o*u)*z,t[4]=C*z,t[5]=(c*M*i-y*d*i+y*n*u-e*M*u-c*n*x+e*d*x)*z,t[6]=(y*o*i-r*M*i-y*n*a+e*M*a+r*n*x-e*o*x)*z,t[7]=(r*d*i-c*o*i+c*n*a-e*d*a-r*n*u+e*o*u)*z,t[8]=w*z,t[9]=(y*l*i-c*m*i-y*s*u+e*m*u+c*s*x-e*l*x)*z,t[10]=(r*m*i-y*h*i+y*s*a-e*m*a-r*s*x+e*h*x)*z,t[11]=(c*h*i-r*l*i-c*s*a+e*l*a+r*s*u-e*h*u)*z,t[12]=f*z,t[13]=(c*m*n-y*l*n+y*s*d-e*m*d-c*s*M+e*l*M)*z,t[14]=(y*h*n-r*m*n-y*s*o+e*m*o+r*s*M-e*h*M)*z,t[15]=(r*l*n-c*h*n+c*s*o-e*l*o-r*s*d+e*h*d)*z,this}scale(t){const e=this.elements,s=t.x,n=t.y,i=t.z;return e[0]*=s,e[4]*=n,e[8]*=i,e[1]*=s,e[5]*=n,e[9]*=i,e[2]*=s,e[6]*=n,e[10]*=i,e[3]*=s,e[7]*=n,e[11]*=i,this}getMaxScaleOnAxis(){const t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],s=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],n=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,s,n))}makeTranslation(t,e,s){return t.isVector3?this.set(1,0,0,t.x,0,1,0,t.y,0,0,1,t.z,0,0,0,1):this.set(1,0,0,t,0,1,0,e,0,0,1,s,0,0,0,1),this}makeRotationX(t){const e=Math.cos(t),s=Math.sin(t);return this.set(1,0,0,0,0,e,-s,0,0,s,e,0,0,0,0,1),this}makeRotationY(t){const e=Math.cos(t),s=Math.sin(t);return this.set(e,0,s,0,0,1,0,0,-s,0,e,0,0,0,0,1),this}makeRotationZ(t){const e=Math.cos(t),s=Math.sin(t);return this.set(e,-s,0,0,s,e,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(t,e){const s=Math.cos(e),n=Math.sin(e),i=1-s,r=t.x,h=t.y,o=t.z,a=i*r,c=i*h;return this.set(a*r+s,a*h-n*o,a*o+n*h,0,a*h+n*o,c*h+s,c*o-n*r,0,a*o-n*h,c*o+n*r,i*o*o+s,0,0,0,0,1),this}makeScale(t,e,s){return this.set(t,0,0,0,0,e,0,0,0,0,s,0,0,0,0,1),this}makeShear(t,e,s,n,i,r){return this.set(1,s,i,0,t,1,r,0,e,n,1,0,0,0,0,1),this}compose(t,e,s){const n=this.elements,i=e._x,r=e._y,h=e._z,o=e._w,a=i+i,c=r+r,l=h+h,d=i*a,u=i*c,y=i*l,m=r*c,M=r*l,x=h*l,E=o*a,C=o*c,w=o*l,f=s.x,b=s.y,z=s.z;return n[0]=(1-(m+x))*f,n[1]=(u+w)*f,n[2]=(y-C)*f,n[3]=0,n[4]=(u-w)*b,n[5]=(1-(d+x))*b,n[6]=(M+E)*b,n[7]=0,n[8]=(y+C)*z,n[9]=(M-E)*z,n[10]=(1-(d+m))*z,n[11]=0,n[12]=t.x,n[13]=t.y,n[14]=t.z,n[15]=1,this}decompose(t,e,s){const n=this.elements;let i=O.set(n[0],n[1],n[2]).length();const r=O.set(n[4],n[5],n[6]).length(),h=O.set(n[8],n[9],n[10]).length();this.determinant()<0&&(i=-i),t.x=n[12],t.y=n[13],t.z=n[14],T.copy(this);const a=1/i,c=1/r,l=1/h;return T.elements[0]*=a,T.elements[1]*=a,T.elements[2]*=a,T.elements[4]*=c,T.elements[5]*=c,T.elements[6]*=c,T.elements[8]*=l,T.elements[9]*=l,T.elements[10]*=l,e.setFromRotationMatrix(T),s.x=i,s.y=r,s.z=h,this}makePerspective(t,e,s,n,i,r,h=tt){const o=this.elements,a=2*i/(e-t),c=2*i/(s-n),l=(e+t)/(e-t),d=(s+n)/(s-n);let u,y;if(h===tt)u=-(r+i)/(r-i),y=-2*r*i/(r-i);else if(h===lt)u=-r/(r-i),y=-r*i/(r-i);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+h);return o[0]=a,o[4]=0,o[8]=l,o[12]=0,o[1]=0,o[5]=c,o[9]=d,o[13]=0,o[2]=0,o[6]=0,o[10]=u,o[14]=y,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this}makeOrthographic(t,e,s,n,i,r,h=tt){const o=this.elements,a=1/(e-t),c=1/(s-n),l=1/(r-i),d=(e+t)*a,u=(s+n)*c;let y,m;if(h===tt)y=(r+i)*l,m=-2*l;else if(h===lt)y=i*l,m=-1*l;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+h);return o[0]=2*a,o[4]=0,o[8]=0,o[12]=-d,o[1]=0,o[5]=2*c,o[9]=0,o[13]=-u,o[2]=0,o[6]=0,o[10]=m,o[14]=-y,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this}equals(t){const e=this.elements,s=t.elements;for(let n=0;n<16;n++)if(e[n]!==s[n])return!1;return!0}fromArray(t,e=0){for(let s=0;s<16;s++)this.elements[s]=t[s+e];return this}toArray(t=[],e=0){const s=this.elements;return t[e]=s[0],t[e+1]=s[1],t[e+2]=s[2],t[e+3]=s[3],t[e+4]=s[4],t[e+5]=s[5],t[e+6]=s[6],t[e+7]=s[7],t[e+8]=s[8],t[e+9]=s[9],t[e+10]=s[10],t[e+11]=s[11],t[e+12]=s[12],t[e+13]=s[13],t[e+14]=s[14],t[e+15]=s[15],t}}const O=new I,T=new L,vt=new I(0,0,0),Ut=new I(1,1,1),F=new I,et=new I,k=new I,_t=new L,yt=new gt;class rt{constructor(t=0,e=0,s=0,n=rt.DEFAULT_ORDER){this.isEuler=!0,this._x=t,this._y=e,this._z=s,this._order=n}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,e,s,n=this._order){return this._x=t,this._y=e,this._z=s,this._order=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,e=this._order,s=!0){const n=t.elements,i=n[0],r=n[4],h=n[8],o=n[1],a=n[5],c=n[9],l=n[2],d=n[6],u=n[10];switch(e){case"XYZ":this._y=Math.asin(A(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(-c,u),this._z=Math.atan2(-r,i)):(this._x=Math.atan2(d,a),this._z=0);break;case"YXZ":this._x=Math.asin(-A(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(h,u),this._z=Math.atan2(o,a)):(this._y=Math.atan2(-l,i),this._z=0);break;case"ZXY":this._x=Math.asin(A(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(-l,u),this._z=Math.atan2(-r,a)):(this._y=0,this._z=Math.atan2(o,i));break;case"ZYX":this._y=Math.asin(-A(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(d,u),this._z=Math.atan2(o,i)):(this._x=0,this._z=Math.atan2(-r,a));break;case"YZX":this._z=Math.asin(A(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-c,a),this._y=Math.atan2(-l,i)):(this._x=0,this._y=Math.atan2(h,u));break;case"XZY":this._z=Math.asin(-A(r,-1,1)),Math.abs(r)<.9999999?(this._x=Math.atan2(d,a),this._y=Math.atan2(h,i)):(this._x=Math.atan2(-c,u),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+e)}return this._order=e,s===!0&&this._onChangeCallback(),this}setFromQuaternion(t,e,s){return _t.makeRotationFromQuaternion(t),this.setFromRotationMatrix(_t,e,s)}setFromVector3(t,e=this._order){return this.set(t.x,t.y,t.z,e)}reorder(t){return yt.setFromEuler(this),this.setFromQuaternion(yt,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],t[3]!==void 0&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}rt.DEFAULT_ORDER="XYZ";typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:xt}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=xt);var ht,D,R,p,mt,at,st,nt,Z,P,it,S;window.onload=_=>{console.log("page loaded, proceed to init");const t=document.getElementById("overlay"),e=document.getElementById("btnStart"),s=document.getElementById("app");e.addEventListener("click",function(n){Qt(),document.body.removeChild(t),s.style.display="block"})};function Qt(){console.log("init function called"),at=document.querySelector("a-scene"),st=document.querySelector("[gps-new-camera]"),st.setAttribute("camera",{far:100}),nt=document.createElement("div"),nt.id="distanceDisplay",document.body.appendChild(nt),Z=document.createElement("div"),Z.id="compassContainer",document.body.appendChild(Z),P=document.createElement("div"),P.id="compassArrow",P.innerText="↑",Z.appendChild(P),it=document.createElement("div"),it.id="compassText",Z.appendChild(it),S=new H(st.object3D),mt=[3,5.5,12],p={latitude:null,longitude:null},R={latitude:51.935416,longitude:7.651882},ht=!1,D=null,window.addEventListener("camera-rotation-change",_=>{S.update();let t=jt();if(it.innerText=`${Math.round(t)}°`,P.style.transform=`rotate(${-t}deg)`,H.isIOS&&D===null&&S.deviceOrientation){const e=Nt(S.object.quaternion);D=(S.deviceOrientation.webkitCompassHeading||0)-e,console.log("Kalibrierungs-Offset gesetzt:",D)}p.latitude!==null&&p.longitude!==null&&Bt(S.object.quaternion,p.latitude,p.longitude,R.latitude,R.longitude)}),st.addEventListener("gps-camera-update-position",_=>{if(p.latitude=_.detail.position.latitude,p.longitude=_.detail.position.longitude,p.latitude&&p.longitude){const t=$t(p.latitude,p.longitude,R.latitude,R.longitude);nt.innerText=`Entfernung zum Ziel: ${Math.round(t)} m`;let e;if(H.isIOS&&D!==null?e=(ct(p.latitude,p.longitude,R.latitude,R.longitude)+D+360)%360:e=ct(p.latitude,p.longitude,R.latitude,R.longitude),document.querySelectorAll("a-sphere").forEach(s=>s.remove()),mt.forEach((s,n)=>{const i=document.createElement("a-sphere");i.setAttribute("color","#00008B"),i.setAttribute("opacity","0.7");const r=Gt(p.latitude,p.longitude,s,e);i.setAttribute("gps-new-entity-place",{latitude:r.latitude,longitude:r.longitude});let h;n===0?h=.3:n===1?h=.4:n===2&&(h=.65),i.setAttribute("radius",h.toString()),at.appendChild(i)}),!ht){const s=document.createElement("a-image");s.setAttribute("src","./images/map-marker.png"),s.setAttribute("width","4"),s.setAttribute("height","4"),s.setAttribute("look-at","[gps-new-camera]"),s.setAttribute("gps-new-entity-place",{latitude:R.latitude,longitude:R.longitude}),at.appendChild(s),ht=!0}}else console.error("Keine aktuellen Koordinaten vorhanden!"),Kt("Keine aktuellen Koordinaten vorhanden!")})}function jt(){if(H.isIOS&&S.deviceOrientation)return S.deviceOrientation.webkitCompassHeading||0;{const _=S.object.quaternion,t=new rt().setFromQuaternion(_,"YXZ");let e=qt.radToDeg(t.y);return e=Math.abs((e-360)%360),e}}function Bt(_,t,e,s,n){const i=ct(s,n,t,e),h=Wt(_).yaw;Jt(h,i)<15?Vt():P.style.color="red"}function Vt(){P.style.color="green"}function Nt(_){const{x:t,y:e,z:s,w:n}=_;let i=Math.atan2(2*(n*s+t*e),1-2*(e*e+s*s))*180/Math.PI;return i<0&&(i+=360),i}function Gt(_,t,e,s){const n=Math.PI/180,i=6371e3,r=s*n,h=_*n,o=t*n,a=Math.asin(Math.sin(h)*Math.cos(e/i)+Math.cos(h)*Math.sin(e/i)*Math.cos(r)),c=o+Math.atan2(Math.sin(r)*Math.sin(e/i)*Math.cos(h),Math.cos(e/i)-Math.sin(h)*Math.sin(a));return{latitude:a/n,longitude:c/n}}function $t(_,t,e,s){const i=Math.PI/180,r=(e-_)*i,h=(s-t)*i,o=Math.sin(r/2)**2+Math.cos(_*i)*Math.cos(e*i)*Math.sin(h/2)**2;return 6371e3*(2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o)))}function Kt(_){alert(_)}function ct(_,t,e,s){const n=_*Math.PI/180,i=e*Math.PI/180,r=(s-t)*Math.PI/180,h=Math.sin(r)*Math.cos(i),o=Math.cos(n)*Math.sin(i)-Math.sin(n)*Math.cos(i)*Math.cos(r);return(Math.atan2(h,o)*180/Math.PI+360)%360}function Wt(_){const t=_.x,e=_.y,s=_.z,n=_.w,i=2*(n*t+e*s),r=1-2*(t*t+e*e),h=Math.atan2(i,r),o=2*(n*e-s*t);let a;Math.abs(o)>=1?a=Math.sign(o)*Math.PI/2:a=Math.asin(o);const c=2*(n*s+t*e),l=1-2*(e*e+s*s);let d=Math.atan2(c,l)*180/Math.PI;return d<0&&(d+=360),{roll:h*180/Math.PI,pitch:a*180/Math.PI,yaw:d}}function Jt(_,t){let e=Math.abs(_-t)%360;return e>180&&(e=360-e),e}
