(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))r(e);new MutationObserver(e=>{for(const t of e)if(t.type==="childList")for(const o of t.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function s(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?t.credentials="include":e.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function r(e){if(e.ep)return;e.ep=!0;const t=s(e);fetch(e.href,t)}})();window.onload=()=>{let i=!1,n=!1,s={alpha:null,beta:null,gamma:null},r=null;const e=document.createElement("div");e.id="distanceDisplay",document.body.appendChild(e);const t=document.createElement("div");t.id="compassContainer",document.body.appendChild(t);const o=document.createElement("div");o.id="compassArrow",o.innerText="↑",t.appendChild(o);const c=document.createElement("div");c.id="compassText",t.appendChild(c),window.addEventListener("deviceorientation",a=>{a.alpha!==null&&(n=!0,s.alpha=a.alpha,s.beta=a.beta,s.gamma=a.gamma,o.style.transform=`rotate(${-a.alpha}deg)`,c.innerText=`${Math.round(a.alpha)}°`)});const u=document.createElement("button");u.id="calibButton",u.innerText="Kalibrieren",document.body.appendChild(u),u.addEventListener("click",()=>{n&&s.alpha!==null?(r=s.alpha*Math.PI/180,y("Kalibrierung gesetzt!"),console.log("Kalibrierter Heading (in Radianten):",r)):y("Keine Sensordaten für Kalibrierung verfügbar!")});const d={latitude:51.935502,longitude:7.652093},m=[3,6,9,12,15],p=document.querySelector("a-scene");document.querySelector("[gps-new-camera]").addEventListener("gps-camera-update-position",a=>{if(!n){console.log("Warte auf vollständige Sensordaten...");return}const h=a.detail.position.latitude,M=a.detail.position.longitude;y("GPS-Position aktualisiert");const b=L(h,M,d.latitude,d.longitude);e.innerText=`Entfernung zum Ziel: ${Math.round(b)} m`;let C=0;if(r!==null&&(C=s.alpha*Math.PI/180-r),document.querySelectorAll("a-circle").forEach(l=>l.parentNode.removeChild(l)),m.forEach(l=>{const f=document.createElement("a-circle");f.setAttribute("radius","0.5"),f.setAttribute("color","#00008B"),f.setAttribute("opacity","0.7");const P=w(h,M,d.latitude,d.longitude,l,C);f.setAttribute("gps-new-entity-place",{latitude:P.latitude,longitude:P.longitude}),p.appendChild(f)}),!i){const l=document.createElement("a-image");l.setAttribute("src","./images/map-marker.png"),l.setAttribute("width","4"),l.setAttribute("height","4"),l.setAttribute("look-at","[gps-new-camera]"),l.setAttribute("gps-new-entity-place",{latitude:d.latitude,longitude:d.longitude}),p.appendChild(l),i=!0}})};function E(i,n,s,r,e){const t=i*Math.PI/180,o=n*Math.PI/180,c=s*Math.PI/180,d=r*Math.PI/180-o,m=Math.sin(d)*Math.cos(c),p=Math.cos(t)*Math.sin(c)-Math.sin(t)*Math.cos(c)*Math.cos(d),g=Math.atan2(m,p),a=6371e3,h=e,M=Math.asin(Math.sin(t)*Math.cos(h/a)+Math.cos(t)*Math.sin(h/a)*Math.cos(g)),b=o+Math.atan2(Math.sin(g)*Math.sin(h/a)*Math.cos(t),Math.cos(h/a)-Math.sin(t)*Math.sin(M));return{latitude:M*180/Math.PI,longitude:b*180/Math.PI}}function w(i,n,s,r,e,t){const o=E(i,n,s,r,e),c=111320,u=40075e3*Math.cos(i*Math.PI/180)/360,d=(o.latitude-i)*c,m=(o.longitude-n)*u,p=m*Math.cos(t)-d*Math.sin(t),g=m*Math.sin(t)+d*Math.cos(t),a=i+g/c,h=n+p/u;return{latitude:a,longitude:h}}function L(i,n,s,r){const t=Math.PI/180,o=(s-i)*t,c=(r-n)*t,u=Math.sin(o/2)*Math.sin(o/2)+Math.cos(i*t)*Math.cos(s*t)*Math.sin(c/2)*Math.sin(c/2);return 6371e3*(2*Math.atan2(Math.sqrt(u),Math.sqrt(1-u)))}function y(i){const n=document.createElement("div");n.className="toast",n.innerText=i,document.body.appendChild(n),setTimeout(()=>{n.remove()},1e3)}
