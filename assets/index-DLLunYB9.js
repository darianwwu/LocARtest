(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))p(t);new MutationObserver(t=>{for(const r of t)if(r.type==="childList")for(const u of r.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&p(u)}).observe(document,{childList:!0,subtree:!0});function y(t){const r={};return t.integrity&&(r.integrity=t.integrity),t.referrerPolicy&&(r.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?r.credentials="include":t.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function p(t){if(t.ep)return;t.ep=!0;const r=y(t);fetch(t.href,r)}})();window.onload=()=>{let h=!1;const a={latitude:51.934548,longitude:7.653734},y=[3,6,12],p=document.querySelector("a-scene"),t=document.querySelector("[gps-new-camera]");t.setAttribute("camera",{far:100});const r=document.createElement("div");r.id="distanceDisplay",document.body.appendChild(r);const u=document.createElement("div");u.id="compassContainer",document.body.appendChild(u);const m=document.createElement("div");m.id="compassArrow",m.innerText="↑",u.appendChild(m);const w=document.createElement("div");w.id="compassText",u.appendChild(w);let g;"AbsoluteOrientationSensor"in window?g=new AbsoluteOrientationSensor({frequency:60}):"RelativeOrientationSensor"in window?g=new RelativeOrientationSensor({frequency:60}):console.error("Keine native Orientierungssensor-Unterstützung vorhanden!"),g&&(g.addEventListener("reading",()=>{const s=g.quaternion,o=M(s);if(m.style.transform=`rotate(${-o}deg)`,w.innerText=`${Math.round(o)}°`,typeof window.currentTargetBearing<"u"){let e=Math.abs(o-window.currentTargetBearing);e>180&&(e=360-e),e<=10?m.style.color="green":m.style.color="white"}}),g.start());function b(s,o,e,c){const i=Math.PI/180,d=Math.sin((c-o)*i)*Math.cos(e*i),n=Math.cos(s*i)*Math.sin(e*i)-Math.sin(s*i)*Math.cos(e*i)*Math.cos((c-o)*i);return(Math.atan2(d,n)*(180/Math.PI)+360)%360}t.addEventListener("gps-camera-update-position",s=>{const o=s.detail.position.latitude,e=s.detail.position.longitude,c=A(o,e,a.latitude,a.longitude);r.innerText=`Entfernung zum Ziel: ${Math.round(c)} m`;let i=0;calibratedQuaternion&&(i=M(currentQuaternion)-M(calibratedQuaternion));const d=b(o,e,a.latitude,a.longitude);if(document.querySelectorAll("a-triangle").forEach(n=>n.remove()),y.forEach(n=>{const l=document.createElement("a-triangle");l.setAttribute("color","#00008B"),l.setAttribute("opacity","0.7");const f=getIntermediateCoordsWithCalibration(o,e,a.latitude,a.longitude,n,i);l.setAttribute("gps-new-entity-place",{latitude:f.latitude,longitude:f.longitude}),l.setAttribute("rotation",`0 ${d} 0`),p.appendChild(l)}),!h){const n=document.createElement("a-image");n.setAttribute("src","./images/map-marker.png"),n.setAttribute("width","4"),n.setAttribute("height","4"),n.setAttribute("look-at","[gps-new-camera]"),n.setAttribute("gps-new-entity-place",{latitude:a.latitude,longitude:a.longitude}),p.appendChild(n),h=!0}});function A(s,o,e,c){const d=Math.PI/180,n=(e-s)*d,l=(c-o)*d,f=Math.sin(n/2)**2+Math.cos(s*d)*Math.cos(e*d)*Math.sin(l/2)**2;return 6371e3*(2*Math.atan2(Math.sqrt(f),Math.sqrt(1-f)))}function M(s){let[o,e,c,i]=s,n=Math.atan2(2*(i*c+o*e),1-2*(e*e+c*c))*(180/Math.PI);return n<0&&(n+=360),n}};
