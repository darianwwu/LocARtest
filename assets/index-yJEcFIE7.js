(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))c(t);new MutationObserver(t=>{for(const e of t)if(e.type==="childList")for(const i of e.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&c(i)}).observe(document,{childList:!0,subtree:!0});function l(t){const e={};return t.integrity&&(e.integrity=t.integrity),t.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?e.credentials="include":t.crossOrigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function c(t){if(t.ep)return;t.ep=!0;const e=l(t);fetch(t.href,e)}})();window.onload=()=>{let m=!1;const n={latitude:51.934548,longitude:7.653734},l=[3,6,12],c=document.querySelector("a-scene"),t=document.querySelector("[gps-new-camera]");t.setAttribute("camera",{far:100});const e=document.createElement("div");e.id="distanceDisplay",document.body.appendChild(e);const i=document.createElement("div");i.id="compassContainer",document.body.appendChild(i);const r=document.createElement("div");r.id="compassArrow",r.innerText="↑",i.appendChild(r);const M=document.createElement("div");M.id="compassText",i.appendChild(M),t.addEventListener("gps-camera-update-position",u=>{const d=u.detail.position.latitude,a=u.detail.position.longitude;console.log("Aktualisierte Nutzerposition");const s=y(d,a,n.latitude,n.longitude);console.log("Entfernung zum Ziel:",s),e.innerText=`Entfernung zum Ziel: ${Math.round(s)} m`;const g=w(d,a,n.latitude,n.longitude);if(console.log("Berechneter Zielwinkel:",g),f(g),!m){console.log("Füge Marker am Ziel hinzu...");const o=document.createElement("a-image");o.setAttribute("src","./images/map-marker.png"),o.setAttribute("width","4"),o.setAttribute("height","4"),o.setAttribute("gps-new-entity-place",{latitude:n.latitude,longitude:n.longitude}),c.appendChild(o),m=!0}document.querySelectorAll("a-triangle").forEach(o=>o.remove()),console.log("Alte Dreiecke entfernt."),l.forEach(o=>{const h=A(d,a,n.latitude,n.longitude,o);if(console.log(`Dreieck bei Distanz ${o}m:`,h),!h||!h.latitude||!h.longitude){console.error("Fehler: Berechnete GPS-Koordinaten sind ungültig.",h);return}const p=document.createElement("a-triangle");p.setAttribute("color","#00008B"),p.setAttribute("opacity","0.7"),p.setAttribute("gps-new-entity-place",{latitude:h.latitude,longitude:h.longitude}),c.appendChild(p)})});function f(u){window.DeviceOrientationEvent&&window.addEventListener("deviceorientation",d=>{const a=d.alpha;if(a!==null){r.style.transform=`rotate(${-a}deg)`,M.innerText=`${Math.round(a)}°`;const s=Math.abs(a-u);s<=10||s>=350?r.style.color="green":r.style.color="white"}})}function y(u,d,a,s){const o=Math.PI/180,h=(a-u)*o,p=(s-d)*o,b=Math.sin(h/2)**2+Math.cos(u*o)*Math.cos(a*o)*Math.sin(p/2)**2;return 6371e3*(2*Math.atan2(Math.sqrt(b),Math.sqrt(1-b)))}};function w(m,n,l,c){const t=Math.PI/180,e=Math.sin((c-n)*t)*Math.cos(l*t),i=Math.cos(m*t)*Math.sin(l*t)-Math.sin(m*t)*Math.cos(l*t)*Math.cos((c-n)*t);return(Math.atan2(e,i)*(180/Math.PI)+360)%360}function A(m,n,l,c,t){const e=m*Math.PI/180,i=n*Math.PI/180,r=l*Math.PI/180,f=c*Math.PI/180-i,y=Math.sin(f)*Math.cos(r),u=Math.cos(e)*Math.sin(r)-Math.sin(e)*Math.cos(r)*Math.cos(f),d=Math.atan2(y,u),a=6371e3,s=t,g=Math.asin(Math.sin(e)*Math.cos(s/a)+Math.cos(e)*Math.sin(s/a)*Math.cos(d)),o=i+Math.atan2(Math.sin(d)*Math.sin(s/a)*Math.cos(e),Math.cos(s/a)-Math.sin(e)*Math.sin(g));return{latitude:g*180/Math.PI,longitude:o*180/Math.PI}}
