(function(){const d=document.createElement("link").relList;if(d&&d.supports&&d.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))s(e);new MutationObserver(e=>{for(const r of e)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function l(e){const r={};return e.integrity&&(r.integrity=e.integrity),e.referrerPolicy&&(r.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?r.credentials="include":e.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(e){if(e.ep)return;e.ep=!0;const r=l(e);fetch(e.href,r)}})();document.addEventListener("DOMContentLoaded",()=>{console.log("DOM fully loaded and parsed");const g=document.getElementById("arrow"),d=document.getElementById("distanceText");if(g)console.log("Arrow model found in DOM");else{console.error("Arrow model not found in DOM");return}const l={latitude:51.9353,longitude:7.649964};let s,e,r=null;const o=t=>t*Math.PI/180,M=t=>t*180/Math.PI;"geolocation"in navigator?(console.log("Geolocation is supported"),navigator.geolocation.watchPosition(t=>{const{latitude:i,longitude:n}=t.coords;s=i,e=n,console.log(`User position updated: lat=${i}, lon=${n}`),p(),m(),$()},t=>console.error("Geolocation error:",t),{enableHighAccuracy:!0,maximumAge:0,timeout:5e3})):console.error("Geolocation not supported by this browser."),window.addEventListener("deviceorientation",w,!0);function w(t){t.alpha!==null&&(r=t.alpha,s!==void 0&&e!==void 0&&(p(),m()))}function p(){if(s===void 0||e===void 0)return;let t;r!==null?t=o(r):t=P(s,e,l.latitude,l.longitude);const n=b(s,e,t,10);g.setAttribute("gps-entity-place",`latitude: ${n.latitude}; longitude: ${n.longitude};`),d.setAttribute("gps-entity-place",`latitude: ${n.latitude}; longitude: ${n.longitude};`)}function m(){if(s===void 0||e===void 0)return;let t=A(g);t||(t={latitude:s,longitude:e});const i=L(t.latitude,t.longitude,l.latitude,l.longitude);console.log(`Calculated bearing from arrow to target: ${i} degrees`),g.setAttribute("rotation",`0 ${i} 0`),d.setAttribute("rotation",`0 ${i} 0`)}function A(t){const i=t.getAttribute("gps-entity-place");if(!i)return null;const n=i.match(/latitude:\s*([-+]?[0-9]*\.?[0-9]+)/),a=i.match(/longitude:\s*([-+]?[0-9]*\.?[0-9]+)/);return n&&a?{latitude:parseFloat(n[1]),longitude:parseFloat(a[1])}:null}function b(t,i,n,a){const c=o(t),h=o(i),u=Math.asin(Math.sin(c)*Math.cos(a/6371e3)+Math.cos(c)*Math.sin(a/6371e3)*Math.cos(n)),y=h+Math.atan2(Math.sin(n)*Math.sin(a/6371e3)*Math.cos(c),Math.cos(a/6371e3)-Math.sin(c)*Math.sin(u));return{latitude:M(u),longitude:M(y)}}function L(t,i,n,a){const f=o(a-i),c=Math.sin(f)*Math.cos(o(n)),h=Math.cos(o(t))*Math.sin(o(n))-Math.sin(o(t))*Math.cos(o(n))*Math.cos(f);let u=M(Math.atan2(c,h));return u=(u+360)%360,u}function P(t,i,n,a){const f=o(a-i),c=Math.sin(f)*Math.cos(o(n)),h=Math.cos(o(t))*Math.sin(o(n))-Math.sin(o(t))*Math.cos(o(n))*Math.cos(f);return Math.atan2(c,h)}function O(t,i,n,a){const c=o(n-t),h=o(a-i),u=Math.sin(c/2)**2+Math.cos(o(t))*Math.cos(o(n))*Math.sin(h/2)**2;return 6371*(2*Math.atan2(Math.sqrt(u),Math.sqrt(1-u)))*1e3}function $(){if(s===void 0||e===void 0)return;const t=O(s,e,l.latitude,l.longitude);d.setAttribute("text","value",`${Math.round(t)} m`)}});
