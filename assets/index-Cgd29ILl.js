(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))r(t);new MutationObserver(t=>{for(const e of t)if(e.type==="childList")for(const l of e.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function i(t){const e={};return t.integrity&&(e.integrity=t.integrity),t.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?e.credentials="include":t.crossOrigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function r(t){if(t.ep)return;t.ep=!0;const e=i(t);fetch(t.href,e)}})();window.onload=()=>{let s=!1,n=!1,i={alpha:null,beta:null,gamma:null},r=null;window.addEventListener("deviceorientation",a=>{a.alpha!==null&&(n=!0,i.alpha=a.alpha,i.beta=a.beta,i.gamma=a.gamma)});const t=document.createElement("button");t.innerText="Kalibrieren",t.style.position="fixed",t.style.bottom="20px",t.style.left="50%",t.style.transform="translateX(-50%)",t.style.padding="10px 20px",t.style.zIndex="10000",document.body.appendChild(t),t.addEventListener("click",()=>{n&&i.alpha!==null?(r=i.alpha*Math.PI/180,M("Kalibrierung gesetzt!"),console.log("Kalibrierter Heading (in Radianten):",r)):M("Keine Sensordaten für Kalibrierung verfügbar!")});const e={latitude:51.935502,longitude:7.652093},l=[3,6,9,12,15],c=document.querySelector("a-scene");document.querySelector("[gps-new-camera]").addEventListener("gps-camera-update-position",a=>{if(!n){console.log("Warte auf vollständige Sensordaten...");return}const p=a.detail.position.latitude,m=a.detail.position.longitude;M("GPS-Position aktualisiert");let u=0;if(r!==null&&(u=i.alpha*Math.PI/180-r),document.querySelectorAll("a-circle").forEach(o=>o.parentNode.removeChild(o)),l.forEach(o=>{const d=document.createElement("a-circle");d.setAttribute("radius","0.5"),d.setAttribute("color","#00008B"),d.setAttribute("opacity","0.7");const f=b(p,m,e.latitude,e.longitude,o,u);d.setAttribute("gps-new-entity-place",{latitude:f.latitude,longitude:f.longitude}),c.appendChild(d)}),!s){const o=document.createElement("a-image");o.setAttribute("src","./images/map-marker.png"),o.setAttribute("width","4"),o.setAttribute("height","4"),o.setAttribute("look-at","[gps-new-camera]"),o.setAttribute("gps-new-entity-place",{latitude:e.latitude,longitude:e.longitude}),c.appendChild(o),s=!0}})};function y(s,n,i,r,t){const e=s*Math.PI/180,l=n*Math.PI/180,c=i*Math.PI/180,a=r*Math.PI/180-l,p=Math.sin(a)*Math.cos(c),m=Math.cos(e)*Math.sin(c)-Math.sin(e)*Math.cos(c)*Math.cos(a),u=Math.atan2(p,m),h=6371e3,o=t,d=Math.asin(Math.sin(e)*Math.cos(o/h)+Math.cos(e)*Math.sin(o/h)*Math.cos(u)),f=l+Math.atan2(Math.sin(u)*Math.sin(o/h)*Math.cos(e),Math.cos(o/h)-Math.sin(e)*Math.sin(d));return{latitude:d*180/Math.PI,longitude:f*180/Math.PI}}function b(s,n,i,r,t,e){const l=y(s,n,i,r,t),c=111320,g=40075e3*Math.cos(s*Math.PI/180)/360,a=(l.latitude-s)*c,p=(l.longitude-n)*g,m=p*Math.cos(e)-a*Math.sin(e),u=p*Math.sin(e)+a*Math.cos(e),h=s+u/c,o=n+m/g;return{latitude:h,longitude:o}}function M(s){const n=document.createElement("div");n.style.position="fixed",n.style.top="20px",n.style.left="50%",n.style.transform="translateX(-50%)",n.style.padding="10px 20px",n.style.backgroundColor="rgba(0, 0, 0, 0.7)",n.style.color="white",n.style.fontSize="14px",n.style.borderRadius="5px",n.style.zIndex="9999",n.innerText=s,document.body.appendChild(n),setTimeout(()=>{n.remove()},1e3)}
