(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))c(t);new MutationObserver(t=>{for(const e of t)if(e.type==="childList")for(const s of e.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&c(s)}).observe(document,{childList:!0,subtree:!0});function u(t){const e={};return t.integrity&&(e.integrity=t.integrity),t.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?e.credentials="include":t.crossOrigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function c(t){if(t.ep)return;t.ep=!0;const e=u(t);fetch(t.href,e)}})();window.onload=()=>{let h=!1;const n={latitude:51.934548,longitude:7.653734},u=[3,6,12],c=document.querySelector("a-scene"),t=document.querySelector("[gps-new-camera]");t.setAttribute("camera",{far,fov:90,near:1});const e=document.createElement("div");e.id="distanceDisplay",document.body.appendChild(e);const s=document.createElement("div");s.id="compassContainer",document.body.appendChild(s);const i=document.createElement("div");i.id="compassArrow",i.innerText="↑",s.appendChild(i);const M=document.createElement("div");M.id="compassText",s.appendChild(M),t.addEventListener("gps-camera-update-position",l=>{const d=l.detail.position.latitude,a=l.detail.position.longitude,r=y(d,a,n.latitude,n.longitude);e.innerText=`Entfernung zum Ziel: ${Math.round(r)} m`;const p=w(d,a,n.latitude,n.longitude);if(g(p),document.querySelectorAll("a-triangle").forEach(o=>o.remove()),u.forEach(o=>{const m=document.createElement("a-triangle");m.setAttribute("color","#00008B"),m.setAttribute("opacity","0.7");const f=A(d,a,n.latitude,n.longitude,o);m.setAttribute("gps-new-entity-place",{latitude:f.latitude,longitude:f.longitude}),m.setAttribute("look-at","[gps-new-camera]"),c.appendChild(m)}),!h){const o=document.createElement("a-image");o.setAttribute("src","./images/map-marker.png"),o.setAttribute("width","4"),o.setAttribute("height","4"),o.setAttribute("look-at","[gps-new-camera]"),o.setAttribute("gps-new-entity-place",{latitude:n.latitude,longitude:n.longitude}),c.appendChild(o),h=!0}});function g(l){window.DeviceOrientationEvent&&window.addEventListener("deviceorientation",d=>{const a=d.alpha;if(a!==null){i.style.transform=`rotate(${-a}deg)`,M.innerText=`${Math.round(a)}°`;const r=Math.abs(a-l);r<=10||r>=350?i.style.color="green":i.style.color="white"}})}function y(l,d,a,r){const o=Math.PI/180,m=(a-l)*o,f=(r-d)*o,b=Math.sin(m/2)**2+Math.cos(l*o)*Math.cos(a*o)*Math.sin(f/2)**2;return 6371e3*(2*Math.atan2(Math.sqrt(b),Math.sqrt(1-b)))}};function w(h,n,u,c){const t=Math.PI/180,e=Math.sin((c-n)*t)*Math.cos(u*t),s=Math.cos(h*t)*Math.sin(u*t)-Math.sin(h*t)*Math.cos(u*t)*Math.cos((c-n)*t);return(Math.atan2(e,s)*(180/Math.PI)+360)%360}function A(h,n,u,c,t){const e=h*Math.PI/180,s=n*Math.PI/180,i=u*Math.PI/180,g=c*Math.PI/180-s,y=Math.sin(g)*Math.cos(i),l=Math.cos(e)*Math.sin(i)-Math.sin(e)*Math.cos(i)*Math.cos(g),d=Math.atan2(y,l),a=6371e3,r=t,p=Math.asin(Math.sin(e)*Math.cos(r/a)+Math.cos(e)*Math.sin(r/a)*Math.cos(d)),o=s+Math.atan2(Math.sin(d)*Math.sin(r/a)*Math.cos(e),Math.cos(r/a)-Math.sin(e)*Math.sin(p));return{latitude:p*180/Math.PI,longitude:o*180/Math.PI}}
